---
title: "Climate_Change"
author: "Slavoljub Petkovic"
date: "May 21, 2017"
output: 
  html_document: 
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview

This project is meant to shed light on several questions related to climate changes. I will be using set of data from Kaggle.com which contains 3 files with temperature details in period of time between 1850 and 2013:


1. Global Average Land Temperature by Country (GlobalLandTemperaturesByCountry.csv)
2. Global Average Land Temperature by State (GlobalLandTemperaturesByState.csv)
3. Global Land Temperatures by Major City (GlobalLandTemperaturesByMajorCity.csv)

[Data can be located here] (https://www.kaggle.com/berkeleyearth/climate-change-earth-surface-temperature-data)

In this research, I will attempt to answer few questions below:

1. What is the difference between Land and Ocean average temperature over the time? 
2. Does the rate of change over the continent correlate with changes over the states around the world?
3. What are the top 5 hottest and top 5 coldest major cities in the world?
4. What kind of climate we can expect in next 5 years, 10 years, 50 years and 100 years based on predictive analysis?
5. Is there an active global warming?

I will be providing the analysis that might include dynamic graphs and charts with short explanation of what each of them means and why is it important for us.

# Data Wrangling

* Removing irrelevant columns and rows
* Standardizing Column Names
* Exploring the data for missing values and NA
* Formatting values for consistency
* Explore outliers with min and max to see the extremes 
* Merging data to streamline the analysis flow

```{r ilibraries, message=FALSE, warning=FALSE, include=FALSE}
library(magrittr)
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
library(reshape2)
library(data.table)
library(lubridate)
```

## Statistical Analysis

### Analysis Of Global Temperature (Land Vs Ocean)

Based on the Average Temperature Graph bellow, we can see that average temperature of the land has been significantly increasing with higher rate than temperature of the ocean. Oceans are heating and cooling much faster than land due to low density of the water. There are few factors that could cause average land temperature to increase with higher rate than ocean average temperature. With rapid deforestation, we reduce absorption of greenhouse gases that fuel global warming. Fewer forest will allow larger amounts of greenhouse gases to enter the atmosphere, trap the solar rays and heat up the surface that once has been protected by forest. Industrial effects with developed and developing countries plays the significant role where emission of greenhouse gasses (CO and CO2) directly influences speed and severity of the temperature in those regions and globally as well. 

```{r TempGlobal, echo=FALSE, message=FALSE, warning=FALSE}
# Loading data set
GlobalTemperatures <- read_csv("C:/GIT/R/Climate_Change/Data_Source/GlobalTemperatures.csv")
View(GlobalTemperatures)
# Standardizing the date format
GlobalTemperatures$dt = as.Date(GlobalTemperatures$dt, "%Y-%m-%d" ) 
# Filtering data range
GlobalTemperatures <- filter(GlobalTemperatures, dt>= "1849-12-31")
# Extracting the month out of the dt column in to new Monthviw column
GlobalTemperatures$Month <- month(GlobalTemperatures$dt)
# Converting month number in to Month Name
GlobalTemperatures$Month <- month(GlobalTemperatures$Month, label = TRUE)
# Extracting the year out of the dt column in to new Year column
GlobalTemperatures$Year <- year(GlobalTemperatures$dt)
# Selecting the columns of interest
GlobalTemperatures <- select(GlobalTemperatures,dt,LandAverageTemperature, LandAndOceanAverageTemperature, Month, Year)
# Remove rows that contains NA
GlobalTemperatures <- GlobalTemperatures[!is.na(GlobalTemperatures$LandAndOceanAverageTemperature)  | !is.na(GlobalTemperatures$LandAverageTemperature),]
# Calculate AverageOcean Temperature
GlobalTemperatures$OceanAverageTemperature = as.numeric(GlobalTemperatures$LandAndOceanAverageTemperature) * 2 - as.numeric(GlobalTemperatures$LandAverageTemperature)
# Summerizing temperature on yearly level
GlobalTemperaturesSummary <- GlobalTemperatures %>% group_by(Year) %>% summarise(AvgLandTmp = mean(LandAverageTemperature), AvgOcnTmp = mean(OceanAverageTemperature))
# Ploting Avgerage Ocean Temperature and Average Land temperature on timescale
Plot_ds <-melt(GlobalTemperaturesSummary, id ="Year")
ggplot(data= Plot_ds, aes(x=Year, y= value, colour = variable)) +
	   geom_line() + coord_cartesian(ylim = c(0, 40)) + xlab("Years") + ylab("Average Temperature") +
	   theme(axis.title = element_text(size = 15), axis.text = element_text(size = 13)) +
	   ggtitle("Average Temperature Trend") +
	   theme(plot.title = element_text(size = 13, lineheight=.8, face="bold"))
```


 


### Average Temperature Difference Between 1850 and 2013


```{R avgtmp, echo=FALSE, message=FALSE, warning=FALSE}
# Loading data set
GlobalLandTemperaturesByState <- read_csv("C:/GIT/R/Climate_Change/Data_Source/GlobalLandTemperaturesByState.csv")
View(GlobalLandTemperaturesByState)
# Formating dates
GlobalLandTemperaturesByState$dt <- as.Date(GlobalLandTemperaturesByState$dt, "%Y-%m-%d")
# Filtering data range
GlobalLandTemperaturesByState <- filter(GlobalLandTemperaturesByState, dt>= "1849-12-31")
#  Removing NAs
GlobalLandTemperaturesByState = na.omit(GlobalLandTemperaturesByState)
# Extracting Month from dt column in to new  Month column
GlobalLandTemperaturesByState$Month <- month(GlobalLandTemperaturesByState$dt)
GlobalLandTemperaturesByState$Year <- year(GlobalLandTemperaturesByState$dt)
# Extract avg temperature by year
GlobalTempSummary <- GlobalLandTemperaturesByState %>% group_by(Year) %>% summarise(AvgTemp = mean(AverageTemperature))
# Creating plot
ggplot(data = GlobalTempSummary, aes(x = Year, y = AvgTemp, colour = AvgTemp)) + geom_point(shape=16, size =3) + geom_smooth(method = 'loess', color = 'blue', size = 2) + xlab("Years") + ylab("AllAverage Temperature") + theme(axis.title = element_text(size = 15), axis.text = element_text(size = 13)) + ggtitle("All States Average Temperature Trend") + theme(plot.title = element_text(size = 13, lineheight=.8, face="bold")) + aes(Colour = AvgTemp) + scale_color_gradient(low = "blue", high = "red")
```

### Top 10 hottest and coldest cities in period of 1850 - 2013

```{r TempByMajorCity}
# Loading data set
GlTempCity <- read_csv("C:/GIT/R/Climate_Change/Data_Source/GlobalLandTemperaturesByMajorCity.csv")
View(GlTempCity)
#Formating Data Range
GlTempCity$dt <- as.Date(GlTempCity$dt, "%Y-%m-%d")
# Filtering data range
GlTempCity <- filter(GlTempCity, dt>= "1849-12-31")
# Filtering out NAs
GlTempCity = na.omit(GlTempCity)
# Extracting the month out of dt
GlTempCity$Month <- month(GlTempCity$dt)
# Converting Month number to Month Name
GlTempCity$Month <- month(GlTempCity$Month, label = TRUE)
# Extracting the year out of dt
GlTempCity$Year <- year(GlTempCity$dt)
# Grouping by City with avg. temperature on average
GlTempSum <- GlTempCity %>% group_by(City) %>% summarise(AvgTemp = mean(AverageTemperature))
# Extracting top 10 hotest city
Top10Hotest <- head(arrange(GlTempSum, desc(AvgTemp)), n= 10)
# Extracting top 10 coldest city on average
Top10Coldest <- head(arrange(GlTempSum, AvgTemp), n = 10)
# Plotting the the top 10 coldest cities
ggplot(data = Top10Coldest, aes(x = reorder(City, - AvgTemp), y = AvgTemp)) + geom_bar(stat = "identity", position = "dodge", fill="steelblue") + geom_text(aes(label=format(Top10Coldest$AvgTemp, digits = 2)), vjust=1.6, color="white", size=3.5) + theme_minimal() + xlab("Coldest Cities") + ylab("Minimum Avergate Temp in (C)") + theme(axis.title = element_text(size = 15), axis.text = element_text(size = 13)) + ggtitle("Top 10 Coldest cities between 1850 - 2013") + theme(plot.title = element_text(size = 13, lineheight=.8, face="bold")) + theme(axis.text.x = element_text(size  = 10, angle = 45, hjust = 1, vjust = 1))
# Plotting the top 10 hottest cities
ggplot(data = Top10Hotest, aes(x = reorder(City, - AvgTemp), y = AvgTemp)) + geom_bar(stat = "identity", position = "dodge", fill="#FF9999") + geom_text(aes(label=format(Top10Hotest$AvgTemp, digits = 2)), vjust=1.6, color="white", size=3.5) + theme_minimal() + xlab("Coldest Cities") + ylab("Minimum Avergate Temp in (C)") + theme(axis.title = element_text(size = 15), axis.text = element_text(size = 13)) + ggtitle("Top 10 hotest cities between 1850 - 2013") + theme(plot.title = element_text(size = 13, lineheight=.8, face="bold")) + theme(axis.text.x = element_text(size  = 10, angle = 45, hjust = 1, vjust = 1)) + coord_cartesian(ylim = c(0, 40))

```


### Global Average Land Temperature by Country (GlobalLandTemperaturesByCountry.csv)

```{r TempByCountry}
# Loading data set
GlobalLandTemperaturesByCountry <- read_csv("C:/GIT/R/Climate_Change/Data_Source/GlobalLandTemperaturesByCountry.csv")
View(GlobalLandTemperaturesByCountry)
# Filtering data range
GlobalLandTemperaturesByCountry <- filter(GlobalLandTemperaturesByCountry, dt>= "1849-12-31")
```






